<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>InFinity Inglês | Mapa de Missões</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;800&display=swap');
        
        :root { 
            --if-green: #2f9e41; 
            --primary: #00df9a; 
            --secondary: #2a5ff0; 
            --bg: #f8fafc;      
            --card-bg: #ffffff; 
            --text: #1e293b;    
            --border: #e2e8f0;
        }
        
        body { 
            font-family: 'Poppins', sans-serif; 
            background-color: var(--bg); 
            color: var(--text); 
            margin: 0; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
        }

        .header { text-align: center; margin-bottom: 30px; }
        .logo-text { font-size: 2.5rem; font-weight: 800; line-height: 1; }
        .if-brand { color: var(--if-green); }
        .degrade { 
            background: linear-gradient(45deg, var(--secondary), var(--if-green)); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
        }

        .status-bar {
            background: var(--card-bg); 
            padding: 12px 25px; 
            border-radius: 50px;
            margin-bottom: 40px; 
            border: 1px solid var(--border); 
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .mission-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); 
            gap: 25px; 
            width: 100%; 
            max-width: 600px; 
            padding: 10px;
        }

        .mission-node {
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            text-decoration: none; 
            color: var(--text);
            transition: 0.3s;
            cursor: pointer; /* Adicionado para indicar que é clicável */
        }

        .node-circle {
            width: 65px; 
            height: 65px; 
            border-radius: 50%; 
            background: var(--card-bg); 
            border: 3px solid var(--border);
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-weight: 800; 
            font-size: 1.2rem; 
            transition: 0.3s;
            color: #94a3b8;
        }

        .mission-node:hover .node-circle { 
            border-color: var(--secondary); 
            transform: translateY(-5px);
            color: var(--secondary);
        }

        .completed .node-circle {
            background: var(--if-green); 
            color: white; 
            border-color: #267d34;
            box-shadow: 0 0 15px rgba(47, 158, 65, 0.3);
        }

        .mission-label { 
            font-size: 0.7rem; 
            margin-top: 10px; 
            font-weight: 700; 
            color: #64748b; 
            text-transform: uppercase;
        }

        .completed .mission-label { color: var(--if-green); }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo-text">
            <span class="if-brand">I</span><span class="degrade">n</span><span class="if-brand">F</span><span class="degrade">inity</span>
        </div>
        <p style="color: #64748b; font-weight: 500;">English Mission Map</p>
    </div>

    <div class="status-bar" id="status-text">
        Carregando progresso...
    </div>

    <div class="mission-grid" id="grid"></div>

    <script>
        // --- 1. TRAVA DE LOGIN (SEGURANÇA) ---
        (function verificarLogin() {
            const aluno = localStorage.getItem('aluno_infinity');
            if (!aluno) {
                window.location.href = "login.html";
            }
        })();

        const totalMissions = 15;
        const grid = document.getElementById('grid');
        let completedCount = 0;

        for (let i = 1; i <= totalMissions; i++) {
            const missionId = i.toString().padStart(2, '0'); 
            const isCompleted = localStorage.getItem(`m${missionId}_complete`) === 'true';
            
            if(isCompleted) completedCount++;

            const node = document.createElement('div'); // Mudamos de 'a' para 'div' para controlar o clique
            node.className = `mission-node ${isCompleted ? 'completed' : ''}`;
            
            // --- 2. LÓGICA DE CLIQUE COM TRAVA DE 24H ---
            node.onclick = function() {
                const hoje = new Date().toLocaleDateString();
                const ultimaData = localStorage.getItem('ultima_conclusao');

                // Se o aluno já concluiu essa missão específica, ele pode entrar para revisar
                if (isCompleted) {
                    window.location.href = `missao${missionId}.html`;
                    return;
                }

                
                if (ultimaData === hoje) {
                    alert("Professor Jarbas avisa: Mantenha a constância! Você já praticou hoje. Volte amanhã para a próxima missão e garanta seu bônus.");
                } else {
                    window.location.href = `missao${missionId}.html`;
                }
            };

            node.innerHTML = `
                <div class="node-circle">${i}</div>
                <div class="mission-label">Missão ${missionId}</div>
            `;
            
            grid.appendChild(node);
        }

        document.getElementById('status-text').innerText = `Progresso: ${completedCount} de ${totalMissions} Missões`;
    </script>
</body>
</html>
